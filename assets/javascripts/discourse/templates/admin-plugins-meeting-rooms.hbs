<div class="admin-meeting-rooms">
  <div class="admin-meeting-rooms-header">
    <h2>{{i18n "plugnmeet.admin.title"}}</h2>
    <DButton
      @action={{this.openCreateModal}}
      @label="plugnmeet.admin.create_room"
      @icon="plus"
      class="btn-primary"
    />
  </div>

  {{#if this.model.rooms.length}}
    <table class="meeting-rooms-table">
      <thead>
        <tr>
          <th>{{i18n "plugnmeet.admin.room_name"}}</th>
          <th>{{i18n "plugnmeet.admin.allowed_groups"}}</th>
          <th>{{i18n "plugnmeet.admin.participants"}}</th>
          <th>{{i18n "plugnmeet.admin.created"}}</th>
          <th>{{i18n "plugnmeet.admin.actions"}}</th>
        </tr>
      </thead>
      <tbody>
        {{#each this.model.rooms as |room|}}
          <tr>
            <td>
              <strong>{{room.name}}</strong>
            </td>
            <td>
              {{#if room.allowed_group_ids.length}}
                {{#each room.allowed_group_ids as |groupId|}}
                  <span class="badge-group">Group {{groupId}}</span>
                {{/each}}
              {{else}}
                <em>{{i18n "plugnmeet.admin.all_users"}}</em>
              {{/if}}
            </td>
            <td>
              {{room.participant_count}}
            </td>
            <td>
              {{format-date room.created_at leaveAgo="true"}}
            </td>
            <td>
              <DButton
                @action={{fn this.deleteRoom room}}
                @icon="trash-alt"
                @title="plugnmeet.admin.delete_room"
                class="btn-danger btn-small"
              />
            </td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  {{else}}
    <div class="admin-meeting-rooms-empty">
      <p>{{i18n "plugnmeet.admin.no_rooms_yet"}}</p>
      <p>{{i18n "plugnmeet.admin.create_first_room"}}</p>
    </div>
  {{/if}}

  {{#if this.showCreateModal}}
    <DModal
      @closeModal={{this.closeCreateModal}}
      @title={{i18n "plugnmeet.admin.create_room_modal_title"}}
    >
      <:body>
        <div class="create-room-form">
          <div class="control-group">
            <label>{{i18n "plugnmeet.admin.room_name_label"}}</label>
            <Input
              @type="text"
              @value={{this.newRoomName}}
              placeholder={{i18n "plugnmeet.admin.room_name_placeholder"}}
              class="room-name-input"
            />
          </div>

          <div class="control-group">
            <label>{{i18n "plugnmeet.admin.allowed_groups_label"}}</label>
            <p class="help-text">{{i18n "plugnmeet.admin.allowed_groups_help"}}</p>
            <GroupChooser
              @content={{this.site.groups}}
              @value={{this.selectedGroupIds}}
              @onChange={{this.updateSelectedGroups}}
            />
          </div>
        </div>
      </:body>
      <:footer>
        <DButton
          @action={{this.createRoom}}
          @label="plugnmeet.admin.create"
          @icon="plus"
          @disabled={{not this.newRoomName}}
          class="btn-primary"
        />
        <DButton
          @action={{this.closeCreateModal}}
          @label="cancel"
          class="btn-default"
        />
      </:footer>
    </DModal>
  {{/if}}
</div>
